# Image Extraction Sample

This directory contains sample documents with embedded text **and** images, designed to test the `DocumentExtractionSkill` with `imageAction: generateNormalizedImages`.

## Files

| File | Type | Text Content | Images |
|---|---|---|---|
| `report-with-charts.docx` | Word (.docx) | 4 paragraphs about quarterly sales, customer satisfaction, and outlook | 2 PNG images (120×80 red, 100×100 blue) |
| `inventory-with-photos.xlsx` | Excel (.xlsx) | 5 product rows (ID, Name, Category, Quantity, Status) | 1 PNG image (150×60 green) |

## What Gets Extracted

When processed by the `DocumentExtractionSkill` with `imageAction: generateNormalizedImages`:

### Word Document (`report-with-charts.docx`)

- **Text**: "Quarterly Sales Report — Q4 2025", revenue details, NPS scores, outlook
- **Images**: 2 normalized images (converted to JPEG, with width/height/boundingPolygon metadata)

### Excel File (`inventory-with-photos.xlsx`)

- **Text**: Product inventory data (Wireless Mouse, USB-C Hub, Ergonomic Keyboard, etc.)
- **Images**: 1 normalized image

## How to Test

### Option A: Pull Mode (via Indexer)

Use the sample HTTP requests in [`samples/image-extraction-sample.http`](../image-extraction-sample.http):

1. Create an index, data source, skillset, and indexer (Steps 1–4)
2. Run the indexer (Step 5)
3. Search and verify extracted content (Steps 8–10)

### Option B: Push Mode (Direct)

Send base64-encoded file data directly:

```powershell
# Encode a file
$b64 = [Convert]::ToBase64String([IO.File]::ReadAllBytes("samples/sample-data/image-extraction/report-with-charts.docx"))
```

Then use the push-mode skillset from the `.http` file.

## Regenerating the Files

The files were generated by the tool in `tools/GenerateSampleDocs/`:

```bash
cd tools/GenerateSampleDocs
dotnet run
```

This creates solid-colour PNG images (red, blue, green) and embeds them into the Word and Excel documents using `DocumentFormat.OpenXml`.
